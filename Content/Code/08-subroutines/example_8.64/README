The code in example 8.64 has not been tested.
